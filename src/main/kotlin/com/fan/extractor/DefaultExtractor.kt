package com.fan.extractor

import com.fan.extractor.DefaultExtractor.extractFirmName

object DefaultExtractor {
    fun findAuditingFirm(gonggao: String): String {
        val auditingFirmRegex = Regex("公司拟聘任(.+?)为 2024 年年度的审计机构")
        val matchResult = auditingFirmRegex.find(gonggao)
        return matchResult?.groups?.get(1)?.value ?: "未找到合作的会计师事务所信息"
    }

    fun extractFirmName(text: String, pattern: Regex): String? {
        val matchResult = pattern.find(text)
        return matchResult?.groups?.get(1)?.value?.trim()
    }


}

fun main() {
    // 示例公告文本
    val announcementText = "分析如下公告，学习并新增新的模式：\n" +
            "证券代码：002039 证券简称：黔源电力 公告编号：2024-012 贵州黔源电力股份有限公司 关于续聘2024年度会计师事务所的公告 本公司及董事会全体成员保证信息披露的内容真实、准确、完整，没有虚假记载、误导性陈述或重大遗漏。 贵州黔源电力股份有限公司（以下简称公司）于2024年3月28日召开了公司 第十届董事会第十三次会议，审议通过了《关于续聘天职国际会计师事务所（特 殊普通合伙）为公司2024年度审计机构的议案》，拟续聘天职国际会计师事务所 （特殊普通合伙）（以下简称天职国际）为公司2024年度审计机构，并提交2023 年度股东大会审议。现将相关事项公告如下： 一、拟续聘会计师事务所的基本情况 （一）机构信息 1、基本信息 天职国际会计师事务所（特殊普通合伙）（以下简称“天职国际”）创立于 1988年12月，总部北京，是一家专注于审计鉴证、资本市场服务、管理咨询、政 务咨询、税务服务、法务与清算、信息技术咨询、工程咨询、企业估值的特大型 综合性咨询机构。 天职国际首席合伙人为邱靖之，注册地址为北京市海淀区车公庄西路19号68 号楼A-1和A-5区域，组织形式为特殊普通合伙。 天职国际已取得北京市财政局颁发的执业证书，是中国首批获得证券期货相 关业务资格，获准从事特大型国有企业审计业务资格，取得金融审计资格，取得 会计司法鉴定业务资格，以及取得军工涉密业务咨询服务安全保密资质等国家实 行资质管理的最高执业资质的会计师事务所之一，并在美国 PCAOB 注册。天职 国际过去二十多年一直从事证券服务业务。 截至2022年12月31日，天职国际合伙人85人，注册会计师1061人，签署过 证券服务业务审计报告的注册会计师347人。 天职国际2022年度经审计的收入总额31.22亿元，审计业务收入25.18亿元, 证券业务收入12.03亿元。2022年度上市公司审计客户248家，主要行业（证监会门类行业，下同）包括制造业、信息传输、软件和信息技术服务业、电力、热力、燃气及水生产和供应业、批发和零售业、交通运输、仓储和邮政业等，审计收费总额3.19亿元，本公司同行业上市公司审计客户13家。 2、投资者保护能力 天职国际按照相关法律法规在以前年度已累计计提足额的职业风险基金，已计提的职业风险基金和购买的职业保险累计赔偿限额不低于20,000万元。职业风险基金计提以及职业保险购买符合相关规定。近三年（2021年度、2022年度、2023年度、2024年初至本公告日止，下同），天职国际不存在因执业行为在相关民事诉讼中承担民事责任的情况。 3、诚信记录 天职国际近三年因执业行为受到刑事处罚0次、行政处罚0次、监督管理措施8次、自律监管措施1次和纪律处分0次。从业人员近三年因执业行为受到监督管理措施8次，涉及人员24名，不存在因执业行为受到刑事处罚、行政处罚和自律监管措施的情形。 （二）项目信息 1、基本信息 项目合伙人、签字注册会计师、项目质量控制复核人基本信息如下： 项目合伙人及签字注册会计师1：陈智，2000年成为注册会计师，2000年开始从事上市公司审计，2010年开始在本所执业，2024年开始为本公司提供审计服务，近三年签署上市公司审计报告5家，近三年复核上市公司审计报告6家。 签字注册会计师2：朱刚，2019年成为注册会计师，2017年开始从事上市公司审计，2019年开始在本所执业，2019年开始为本公司提供审计服务，近三年签署上市公司审计报告1家。 项目质量控制复核人：王军，1998年成为注册会计师，2005年开始从事上市公司审计，2000年开始在本所执业，2024年开始为本公司提供审计服务，近三年复核上市公司审计报告不少于20家。 2、诚信记录 项目合伙人、签字注册会计师、项目质量控制复核人近三年不存在因执业行为受到刑事处罚，受到证监会及其派出机构、行业主管部门等的行政处罚、监督 管理措施，受到证券交易所、行业协会等自律组织的自律监管措施、纪律处分的情况。 3、独立性 天职国际及项目合伙人、签字注册会计师、项目质量控制复核人等不存在可能影响独立性的情形。 4、审计收费 天职国际审计服务收费按照业务的责任轻重、繁简程度、工作要求、所需的工作条件和工时及实际参加业务的各级别工作人员投入的专业知识和工作经验等因素确定。2024年度审计费用共计78万元（其中：年报审计费用60万元；内控审计费用18万元）。与上一期审计费用相同。 二、续聘会计师事务所履行的程序 （一）审计委员会审议意见 董事会审计委员会对天职国际的执业情况进行了充分的了解，在查阅了天职国际有关资格证照、相关信息和诚信纪录后，一致认可天职国际的独立性、专业胜任能力和投资者保护能力，本次聘任符合财政部、国务院国资委、证监会印发的《国有企业、上市公司选聘会计师事务所管理办法》（财会〔2023〕4号）的规定。 董事会审计委员会就关于续聘会计师事务所的事项形成了书面审核意见，同意续聘天职国际为公司2024年度会计师事务所并提交公司董事会审议。 （二）董事会对议案审议和表决情况 公司于2024年3月28日召开的第十届董事会第十三次会议审议通过了《关于续聘天职国际会计师事务所（特殊普通合伙）为公司2024年度审计机构的议案》，同意续聘天职国际为公司2024年度审计机构。 （三）生效日期 本次续聘天职国际为公司2024年度会计师事务所的事项尚需提交公司2023年度股东大会审议，并自公司股东大会审议通过之日起生效。 四、备查文件 1、贵州黔源电力股份有限公司第十届董事会第十三次会议决议； 2、贵州黔源电力股份有限公司第十届董事会审计委员会2024年第三次会议决议； 3、天职国际会计师事务所营业执照及相关信息。 特此公告。 贵州黔源电力股份有限公司董事会 2024 年 3 月 30 日"
    // 获取会计师事务所名称的匹配规则
    val patterns = listOf(
        "续聘(\\s+(\\w+\\s?){1,3})".toRegex(), // 续聘 [会计师事务所名称]
        "继续聘请(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续聘请 [会计师事务所名称]
        "持续合作(\\s+(\\w+\\s?){1,3})".toRegex(), // 持续合作 [会计师事务所名称]
        "继续雇佣(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续雇佣 [会计师事务所名称]
        "继任(\\s+(\\w+\\s?){1,3})".toRegex(), // 继任 [会计师事务所名称]
        "续签合同(\\s+(\\w+\\s?){1,3})".toRegex(), // 续签合同 [会计师事务所名称]
        "延续服务(\\s+(\\w+\\s?){1,3})".toRegex(), // 延续服务 [会计师事务所名称]
        "延续审计(\\s+(\\w+\\s?){1,3})".toRegex(), // 延续审计 [会计师事务所名称]
        "继续委任(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续委任 [会计师事务所名称]
        "持续雇用(\\s+(\\w+\\s?){1,3})".toRegex(), // 持续雇用 [会计师事务所名称]
        "延续合同(\\s+(\\w+\\s?){1,3})".toRegex(), // 延续合同 [会计师事务所名称]
        "续约(\\s+(\\w+\\s?){1,3})".toRegex(), // 续约 [会计师事务所名称]
        "持续审计(\\s+(\\w+\\s?){1,3})".toRegex(), // 持续审计 [会计师事务所名称]
        "继续任用(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续任用 [会计师事务所名称]
        "继续服务(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续服务
        "续聘(\\s+(\\w+\\s?){1,3})".toRegex(), // 续聘 [会计师事务所名称]
        "继续聘请(\\s+(\\w+\\s?){1,3})".toRegex(), // 继续聘请 [会计师事务所名称]
        // 添加拟变更会计师事务所的名称和原会计师事务所的名称的正则表达式模式
        "拟聘任的会计师事务所名称：(\\s+(\\w+\\s?){1,3})".toRegex(), // 拟聘任的会计师事务所名称： [会计师事务所名称]
        "原聘任的会计师事务所名称：(\\s+(\\w+\\s?){1,3})".toRegex() // 原聘任的会计师事务所名称： [会计师事务所名称]
    )

    // 确定会计师事务所
    var accountingFirm: String? = null
    for (pattern in patterns) {
        val firmName = extractFirmName(announcementText, pattern)
        if (firmName != null) {
            accountingFirm = firmName
            break
        }
    }

    if (accountingFirm != null) {
        println("该公司续聘的会计师事务所是： $accountingFirm")
    } else {
        println("未找到续聘的会计师事务所信息。")
    }
}